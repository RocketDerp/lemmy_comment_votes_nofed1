How did less rows take more time?

         avg          |  min  |  q1   | median |  q3  |         p95          |  max  | repeats 
----------------------+-------+-------+--------+------+----------------------+-------+---------
 0.008820000000000005 | 0.003 | 0.003 |  0.004 | 0.01 | 0.015649999999999994 | 0.087 |      50
(1 row)

CREATE FUNCTION
    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 13725.293 | 13725.293 | 13725.293 | 13725.293 | 13725.293 | 13725.293 | 13725.293 |       1
(1 row)

CREATE FUNCTION
    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 18012.952 | 18012.952 | 18012.952 | 18012.952 | 18012.952 | 18012.952 | 18012.952 |       1
(1 row)

CREATE FUNCTION
     avg     |     min     |     q1      |   median    |     q3      |     p95     |     max     | repeats 
-------------+-------------+-------------+-------------+-------------+-------------+-------------+---------
 1380922.009 | 1380922.009 | 1380922.009 | 1380922.009 | 1380922.009 | 1380922.009 | 1380922.009 |       1
(1 row)

CREATE FUNCTION
    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 34825.846 | 34825.846 | 34825.846 | 34825.846 | 34825.846 | 34825.846 | 34825.846 |       1
(1 row)

CREATE FUNCTION
   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 2732.295 | 2732.295 | 2732.295 | 2732.295 | 2732.295 | 2732.295 | 2732.295 |       1
(1 row)


real	24m10.335s



I didn't change anything but add some output messages, and way faster?

CREATE FUNCTION
         avg          |  min  |  q1   | median |  q3   |         p95          |  max  | repeats 
----------------------+-------+-------+--------+-------+----------------------+-------+---------
 0.003960000000000003 | 0.003 | 0.003 |  0.003 | 0.003 | 0.004549999999999998 | 0.029 |      50
(1 row)

CREATE FUNCTION
   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 18690.31 | 18690.31 | 18690.31 | 18690.31 | 18690.31 | 18690.31 | 18690.31 |       1
(1 row)

CREATE FUNCTION
             ?column?             
----------------------------------
 benchmark_fill_post3 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 23598.217 | 23598.217 | 23598.217 | 23598.217 | 23598.217 | 23598.217 | 23598.217 |       1
(1 row)

CREATE FUNCTION
              ?column?               
-------------------------------------
 benchmark_fill_comment1 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 204715.29 | 204715.29 | 204715.29 | 204715.29 | 204715.29 | 204715.29 | 204715.29 |       1
(1 row)

CREATE FUNCTION
              ?column?               
-------------------------------------
 benchmark_fill_comment2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 29980.427 | 29980.427 | 29980.427 | 29980.427 | 29980.427 | 29980.427 | 29980.427 |       1
(1 row)

CREATE FUNCTION
                 ?column?                  
-------------------------------------------
 benchmark_fill_comment_reply0 kicking off
(1 row)

   avg   |   min   |   q1    | median  |   q3    |   p95   |   max   | repeats 
---------+---------+---------+---------+---------+---------+---------+---------
 3035.07 | 3035.07 | 3035.07 | 3035.07 | 3035.07 | 3035.07 | 3035.07 |       1
(1 row)


real	4m40.117s


delete and rerun

         avg          |  min  |  q1   | median |  q3   |         p95          | max  | repeats 
----------------------+-------+-------+--------+-------+----------------------+------+---------
 0.004160000000000002 | 0.003 | 0.003 |  0.003 | 0.003 | 0.007549999999999998 | 0.03 |      50
(1 row)

CREATE FUNCTION
    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 13440.881 | 13440.881 | 13440.881 | 13440.881 | 13440.881 | 13440.881 | 13440.881 |       1
(1 row)

CREATE FUNCTION
          status_message          
----------------------------------
 benchmark_fill_post3 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 18826.093 | 18826.093 | 18826.093 | 18826.093 | 18826.093 | 18826.093 | 18826.093 |       1
(1 row)

CREATE FUNCTION
           status_message            
-------------------------------------
 benchmark_fill_comment1 kicking off
(1 row)

    avg     |    min     |     q1     |   median   |     q3     |    p95     |    max     | repeats 
------------+------------+------------+------------+------------+------------+------------+---------
 218809.803 | 218809.803 | 218809.803 | 218809.803 | 218809.803 | 218809.803 | 218809.803 |       1
(1 row)

CREATE FUNCTION
           status_message            
-------------------------------------
 benchmark_fill_comment2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 30791.385 | 30791.385 | 30791.385 | 30791.385 | 30791.385 | 30791.385 | 30791.385 |       1
(1 row)

CREATE FUNCTION
              status_message               
-------------------------------------------
 benchmark_fill_comment_reply0 kicking off
(1 row)

   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 2521.066 | 2521.066 | 2521.066 | 2521.066 | 2521.066 | 2521.066 | 2521.066 |       1
(1 row)


real	4m44.482s




---------------
reverse order of the two post creation calls

          status_message          
----------------------------------
 benchmark_fill_post3 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 19381.957 | 19381.957 | 19381.957 | 19381.957 | 19381.957 | 19381.957 | 19381.957 |       1
(1 row)

          status_message          
----------------------------------
 benchmark_fill_post2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 19996.972 | 19996.972 | 19996.972 | 19996.972 | 19996.972 | 19996.972 | 19996.972 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment1 kicking off
(1 row)

    avg     |    min     |     q1     |   median   |     q3     |    p95     |    max     | repeats 
------------+------------+------------+------------+------------+------------+------------+---------
 253836.805 | 253836.805 | 253836.805 | 253836.805 | 253836.805 | 253836.805 | 253836.805 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 35345.686 | 35345.686 | 35345.686 | 35345.686 | 35345.686 | 35345.686 | 35345.686 |       1
(1 row)

              status_message               
-------------------------------------------
 benchmark_fill_comment_reply0 kicking off
(1 row)

   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 2933.079 | 2933.079 | 2933.079 | 2933.079 | 2933.079 | 2933.079 | 2933.079 |       1
(1 row)


real	5m31.592s


delete and re-run, much faster, identical statements...

          status_message          
----------------------------------
 benchmark_fill_post3 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 19557.467 | 19557.467 | 19557.467 | 19557.467 | 19557.467 | 19557.467 | 19557.467 |       1
(1 row)

          status_message          
----------------------------------
 benchmark_fill_post2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 20700.073 | 20700.073 | 20700.073 | 20700.073 | 20700.073 | 20700.073 | 20700.073 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment1 kicking off
(1 row)

    avg     |    min     |     q1     |   median   |     q3     |    p95     |    max     | repeats 
------------+------------+------------+------------+------------+------------+------------+---------
 220957.137 | 220957.137 | 220957.137 | 220957.137 | 220957.137 | 220957.137 | 220957.137 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 33634.334 | 33634.334 | 33634.334 | 33634.334 | 33634.334 | 33634.334 | 33634.334 |       1
(1 row)

              status_message               
-------------------------------------------
 benchmark_fill_comment_reply0 kicking off
(1 row)

   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 2499.316 | 2499.316 | 2499.316 | 2499.316 | 2499.316 | 2499.316 | 2499.316 |       1
(1 row)


real	4m57.476s



Even reverting to the original ordrer, slowness re-appears
again, after full delete

 benchmark_fill_post2 kicking off
(1 row)

   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 17316.29 | 17316.29 | 17316.29 | 17316.29 | 17316.29 | 17316.29 | 17316.29 |       1
(1 row)

          status_message          
----------------------------------
 benchmark_fill_post3 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 23191.761 | 23191.761 | 23191.761 | 23191.761 | 23191.761 | 23191.761 | 23191.761 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment1 kicking off
(1 row)

    avg     |    min     |     q1     |   median   |     q3     |    p95     |    max     | repeats 
------------+------------+------------+------------+------------+------------+------------+---------
 241575.997 | 241575.997 | 241575.997 | 241575.997 | 241575.997 | 241575.997 | 241575.997 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 32905.003 | 32905.003 | 32905.003 | 32905.003 | 32905.003 | 32905.003 | 32905.003 |       1
(1 row)

              status_message               
-------------------------------------------
 benchmark_fill_comment_reply0 kicking off
(1 row)

   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 2801.323 | 2801.323 | 2801.323 | 2801.323 | 2801.323 | 2801.323 | 2801.323 |       1
(1 row)


real	5m17.905s



rerun again, still slow

 benchmark_fill_post2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 17748.982 | 17748.982 | 17748.982 | 17748.982 | 17748.982 | 17748.982 | 17748.982 |       1
(1 row)

          status_message          
----------------------------------
 benchmark_fill_post3 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 22563.794 | 22563.794 | 22563.794 | 22563.794 | 22563.794 | 22563.794 | 22563.794 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment1 kicking off
(1 row)

    avg     |    min     |     q1     |   median   |     q3     |    p95     |    max     | repeats 
------------+------------+------------+------------+------------+------------+------------+---------
 251855.586 | 251855.586 | 251855.586 | 251855.586 | 251855.586 | 251855.586 | 251855.586 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 34057.374 | 34057.374 | 34057.374 | 34057.374 | 34057.374 | 34057.374 | 34057.374 |       1
(1 row)

              status_message               
-------------------------------------------
 benchmark_fill_comment_reply0 kicking off
(1 row)

   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 2880.583 | 2880.583 | 2880.583 | 2880.583 | 2880.583 | 2880.583 | 2880.583 |       1
(1 row)


real	5m29.226s



tuned PostgreSQL from default values (other than data folder)

data_directory = '/WorkSpot0/postgres_data'		# use data in another directory
hba_file = '/etc/postgresql/15/main/pg_hba.conf'	# host-based authentication file
ident_file = '/etc/postgresql/15/main/pg_ident.conf'	# ident configuration file
external_pid_file = '/var/run/postgresql/15-main.pid'			# write an extra PID file
port = 5432				# (change requires restart)
max_connections = 100			# (change requires restart)
unix_socket_directories = '/var/run/postgresql'	# comma-separated list of directories
ssl = on
ssl_cert_file = '/etc/ssl/certs/ssl-cert-snakeoil.pem'
ssl_key_file = '/etc/ssl/private/ssl-cert-snakeoil.key'
shared_buffers = 2048MB			# min 128kB
dynamic_shared_memory_type = posix	# the default is usually the first option
max_wal_size = 2GB
min_wal_size = 120MB
wal_decode_buffer_size = 2048kB		# lookahead window used for prefetching
log_line_prefix = '%m [%p] %q%u@%d '		# special values:
log_timezone = 'America/Phoenix'
cluster_name = '15/main'			# added to process titles if nonempty
datestyle = 'iso, mdy'
timezone = 'America/Phoenix'
lc_messages = 'en_US.UTF-8'			# locale for system error message
lc_monetary = 'en_US.UTF-8'			# locale for monetary formatting
lc_numeric = 'en_US.UTF-8'			# locale for number formatting
lc_time = 'en_US.UTF-8'				# locale for time formatting
default_text_search_config = 'pg_catalog.english'
shared_preload_libraries = 'pg_stat_statements'	# (change requires restart)
pg_stat_statements.track = all
include_dir = 'conf.d'			# include files ending in '.conf' from


didn't make much difference

 benchmark_fill_post2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 16909.609 | 16909.609 | 16909.609 | 16909.609 | 16909.609 | 16909.609 | 16909.609 |       1
(1 row)

          status_message          
----------------------------------
 benchmark_fill_post3 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 19777.149 | 19777.149 | 19777.149 | 19777.149 | 19777.149 | 19777.149 | 19777.149 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment1 kicking off
(1 row)

    avg     |    min     |     q1     |   median   |     q3     |    p95     |    max     | repeats 
------------+------------+------------+------------+------------+------------+------------+---------
 213730.705 | 213730.705 | 213730.705 | 213730.705 | 213730.705 | 213730.705 | 213730.705 |       1
(1 row)

           status_message            
-------------------------------------
 benchmark_fill_comment2 kicking off
(1 row)

    avg    |    min    |    q1     |  median   |    q3     |    p95    |    max    | repeats 
-----------+-----------+-----------+-----------+-----------+-----------+-----------+---------
 32022.435 | 32022.435 | 32022.435 | 32022.435 | 32022.435 | 32022.435 | 32022.435 |       1
(1 row)

              status_message               
-------------------------------------------
 benchmark_fill_comment_reply0 kicking off
(1 row)

   avg    |   min    |    q1    |  median  |    q3    |   p95    |   max    | repeats 
----------+----------+----------+----------+----------+----------+----------+---------
 2213.176 | 2213.176 | 2213.176 | 2213.176 | 2213.176 | 2213.176 | 2213.176 |       1
(1 row)


real	4m44.762s
user	0m0.031s
sys	0m0.007s

